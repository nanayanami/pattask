<%# 投稿一覧押すと、詳細にいくことができる。%>

<div class="posts cover">
  <div class="pd-layout">
    <section class="pd-main">
      <h1 class="posts-title"><%= @post.title %></h1>
      <p class="posts-meta">チーム: <%= @team.name %></p>
      <p class="posts-meta">カテゴリー: <%= @category.name %></p>

      <h1 class="p-h1 pd-h-main">内容</h1>
      <div class="post-content-box">
        <%= @post.content %>
      </div>

      <p class="caption">
        <% if @post.favorited_by?(current_user) %>
          <%= link_to team_category_post_favorites_path(@team, @category, @post), data: { turbo_method: :delete }, class: "favorite_btn" do %>
            ♥<%= @post.favorites.count %>お気に入り済
          <% end %>
        <% else %>
          <%= link_to team_category_post_favorites_path(@team, @category, @post), data: { turbo_method: :post }, class: "favorite_btn" do %>
            ♡<%= @post.favorites.count %>お気に入り
          <% end %>
        <% end %>
      </p>

      <div class="post-head">
        <div class="d-flex gap-2 post-actions">
          <%= link_to "編集する", edit_team_category_post_path(@team, @category, @post),
                      class: "btn btn-success btn-sm btn-edit" %>
          <%= link_to "削除する", team_category_post_path(@team, @category, @post),
                      data: { turbo_method: :delete, turbo_confirm: "本当に消しますか？" },
                      class: "btn btn-danger btn-sm btn-del" %>
        </div>
        <div class="post-back">
          <%= link_to "投稿一覧に戻る", team_category_path(@team, @category),
                      class: "btn btn-dark btn-sm btn-back" %>
        </div>
      </div>
    </section>

    <aside class="pd-comments">
      <h1 class="p-h1 pd-h">コメント</h1>
      <p class="c-count">コメント <%= @post.comments.count %>件</p>

      <%= render "comments/form", team: @team, category: @category, post: @post, comment: @comment %>

      <div class="c-list">
        <% @comments.each do |comment| %>
          <%= render "comments/comment", comment: comment, team: @team, category: @category, post: @post %>
        <% end %>

        <% if @comments.empty? %>
          <p class="c-empty">まだコメントはありません。</p>
        <% end %>
      </div>

      <div class="c-page">
        <%= paginate @comments %>
      </div>
    </aside>
  </div>
</div>